<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Adventure - Fun Learning for Kids!</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- User Selection Screen -->
        <div id="user-selection" class="screen active">
            <div class="container">
                <h1 class="app-title" data-i18n="app_title">🎓 Math Adventure! 🎓</h1>
                <p class="app-subtitle" data-i18n="welcome">Choose your profile or create a new one!</p>
                
                <div id="loading-indicator" class="loading-indicator" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p data-i18n="loading_data">Loading Data...</p>
                </div>
                
                <div id="existing-users" class="users-grid">
                    <!-- Users will be populated by JavaScript -->
                </div>
                
                <div id="data-status-info" class="data-status-info" style="display: none;">
                    <div class="status-message">
                        <span class="status-icon">💾</span>
                        <span data-i18n="progress_restored">Progress Restored</span>
                    </div>
                </div>
                
                <div class="new-user-section">
                    <div class="language-selector-main">
                        <label for="main-language-select" class="form-label" data-i18n="language">Language / Язык / שפה</label>
                        <select id="main-language-select" class="form-control">
                            <option value="en">🇺🇸 English</option>
                            <option value="ru">🇷🇺 Русский</option>
                            <option value="he">🇮🇱 עברית</option>
                        </select>
                    </div>
                    <h3 data-i18n="create_user">Create New User</h3>
                    <div class="form-group">
                        <input type="text" id="new-user-name" data-i18n-placeholder="enter_name" placeholder="Enter your name" class="form-control" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Choose your avatar:</label>
                        <div id="avatar-selection" class="avatar-grid">
                            <!-- Avatars will be populated by JavaScript -->
                        </div>
                    </div>
                    <button id="create-user-btn" class="btn btn--primary btn--lg" data-i18n="start_learning">Start Learning!</button>
                    
                    <div class="data-persistence-info">
                        <div class="info-icon">💾</div>
                        <div class="info-text">
                            <div class="info-title" data-i18n="auto_save_title">Auto-Save Enabled</div>
                            <div class="info-desc" data-i18n="auto_save_desc">All your progress is automatically saved and will be restored when you return!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div id="dashboard" class="screen">
            <div class="container">
                <div class="dashboard-header">
                    <div class="user-info">
                        <span id="current-user-avatar" class="user-avatar"></span>
                        <h2 id="current-user-name">Welcome!</h2>
                    </div>
                    <div class="header-controls">
                        <div class="language-selector">
                            <label for="language-select" class="form-label" data-i18n="language">Language</label>
                            <select id="language-select" class="form-control">
                                <option value="en">🇺🇸 English</option>
                                <option value="ru">🇷🇺 Русский</option>
                                <option value="he">🇮🇱 עברית</option>
                            </select>
                        </div>
                        <button id="switch-user-btn" class="btn btn--secondary btn--sm" data-i18n="switch_user">Switch User</button>
                        <button id="download-app-btn" class="btn btn--outline btn--sm" data-i18n="download_app">📥 Download App</button>
                    </div>
                </div>

                <div class="difficulty-selection-section">
                    <h3 data-i18n="select_difficulty">Select Difficulty Level</h3>
                    <div class="difficulty-selector">
                        <button class="difficulty-btn" data-difficulty="easy">
                            <div class="difficulty-icon">⭐</div>
                            <div class="difficulty-name" data-i18n="difficulty_easy">Easy</div>
                            <div class="difficulty-desc" data-i18n="difficulty_description_easy">Perfect for beginners!</div>
                        </button>
                        <button class="difficulty-btn" data-difficulty="medium">
                            <div class="difficulty-icon">⭐⭐</div>
                            <div class="difficulty-name" data-i18n="difficulty_medium">Medium</div>
                            <div class="difficulty-desc" data-i18n="difficulty_description_medium">Great for students with some experience.</div>
                        </button>
                        <button class="difficulty-btn" data-difficulty="hard">
                            <div class="difficulty-icon">⭐⭐⭐</div>
                            <div class="difficulty-name" data-i18n="difficulty_hard">Hard</div>
                            <div class="difficulty-desc" data-i18n="difficulty_description_hard">Advanced multi-digit problems for math experts!</div>
                            <div class="expert-indicator" data-i18n="expert_level">Expert Level Problems!</div>
                        </button>
                    </div>
                    <div class="current-difficulty-display">
                        <span data-i18n="current_difficulty">Current Level</span>: 
                        <span id="current-difficulty-text" class="difficulty-badge">Easy ⭐</span>
                        <button id="change-difficulty-btn" class="btn btn--sm btn--outline" data-i18n="change_difficulty">Change Difficulty</button>
                    </div>
                </div>

                <div class="stats-overview">
                    <div class="stat-card" id="progress-card">
                        <h3 data-i18n="daily_progress">Today's Progress</h3>
                        <div id="daily-progress" class="progress-circle">
                            <span class="progress-text">0%</span>
                        </div>
                    </div>
                    <div class="stat-card" id="success-card">
                        <h3 data-i18n="success_rate">Success Rate</h3>
                        <div class="big-number formatted-number" id="success-rate">0%</div>
                    </div>
                    <div class="stat-card" id="streak-card">
                        <h3 data-i18n="current_streak">Current Streak</h3>
                        <div class="big-number" id="current-streak">0 🔥</div>
                        <div id="expert-streak-badge" class="expert-indicator" style="display: none;">
                            🏆 Expert Streak!
                        </div>
                    </div>
                </div>

                <div class="exercises-section">
                    <h3 data-i18n="choose_exercise">Choose Your Exercise</h3>
                    <div class="exercise-types">
                        <button class="exercise-btn" data-type="multiplication">
                            <div class="exercise-icon">×</div>
                            <div class="exercise-name" data-i18n="multiplication">Multiplication</div>
                            <div class="exercise-progress" id="mult-progress">0/10 today</div>
                        </button>
                        <button class="exercise-btn" data-type="subtraction">
                            <div class="exercise-icon">−</div>
                            <div class="exercise-name" data-i18n="subtraction">Subtraction</div>
                            <div class="exercise-progress" id="sub-progress">0/10 today</div>
                        </button>
                        <button class="exercise-btn" data-type="division">
                            <div class="exercise-icon">÷</div>
                            <div class="exercise-name" data-i18n="division">Division</div>
                            <div class="exercise-progress" id="div-progress">0/10 today</div>
                        </button>
                        <button class="exercise-btn" data-type="addition">
                            <div class="exercise-icon">+</div>
                            <div class="exercise-name" data-i18n="addition">Addition</div>
                            <div class="exercise-progress" id="add-progress">0/10 today</div>
                        </button>
                    </div>
                </div>

                <div class="achievements-section">
                    <h3 data-i18n="your_achievements">Your Achievements</h3>
                    <div id="achievements-list" class="achievements-grid">
                        <!-- Achievements will be populated by JavaScript -->
                    </div>
                </div>

                <button id="view-progress-btn" class="btn btn--outline btn--full-width" data-i18n="view_progress">View Detailed Progress</button>
            </div>
        </div>

        <!-- Exercise Screen -->
        <div id="exercise" class="screen">
            <div class="container">
                <div class="exercise-header">
                    <button id="back-to-dashboard" class="btn btn--secondary btn--sm" data-i18n="back">← Back</button>
                    <div class="exercise-title-section">
                        <h2 id="exercise-title">Multiplication</h2>
                        <div class="exercise-difficulty-indicator">
                            <span id="exercise-difficulty-badge" class="difficulty-badge">Easy ⭐</span>
                        </div>
                    </div>
                    <div class="exercise-counter">
                        <span id="current-question">1</span> / <span id="total-questions">10</span>
                    </div>
                </div>

                <div class="question-card">
                    <div class="time-indicator" id="time-indicator" style="display: none;">⏱️ <span id="time-remaining">60</span>s</div>
                    <div class="question-instruction" data-i18n="solve_problem">Solve the problem:</div>
                    <div class="math-problem multi-digit-number" id="math-problem">2 × 3 = ?</div>
                    <div class="answer-section">
                        <input type="number" id="answer-input" class="answer-input" data-i18n-placeholder="enter_answer" placeholder="Your answer" inputmode="numeric">
                        <button id="submit-answer" class="btn btn--primary btn--lg" data-i18n="submit">Submit</button>
                    </div>
                </div>

                <div id="feedback" class="feedback hidden">
                    <div class="feedback-message" id="feedback-message">Great job!</div>
                    <div class="celebration-effect" id="celebration-effect"></div>
                    <button id="next-question" class="btn btn--primary" data-i18n="next">Next Question</button>
                </div>

                <div class="exercise-progress-bar">
                    <div class="progress-fill" id="exercise-progress-fill"></div>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results" class="screen">
            <div class="container">
                <div class="results-header">
                    <h2 data-i18n="excellent_work">Excellent Work!</h2>
                    <div class="results-emoji" id="results-emoji">🎉</div>
                </div>

                <div class="results-difficulty-info">
                    <div class="completed-difficulty">
                        <span data-i18n="completed_on">Completed on</span> 
                        <span id="results-difficulty-badge" class="difficulty-badge">Easy ⭐</span>
                        <span data-i18n="difficulty">difficulty</span>
                    </div>
                    <div class="difficulty-progress">
                        <div class="difficulty-progress-fill" id="difficulty-progress-fill"></div>
                    </div>
                    <div id="difficulty-progress-message" class="difficulty-progress-msg"></div>
                    <div id="expert-achievement-notice" class="expert-indicator" style="display: none;">
                        <span data-i18n="multi_digit_warning">Get ready for multi-digit challenges!</span>
                    </div>
                </div>

                <div class="results-stats">
                    <div class="result-stat">
                        <div class="stat-number" id="correct-count">8</div>
                        <div class="stat-label" data-i18n="correct_answers">Correct</div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-number" id="incorrect-count">2</div>
                        <div class="stat-label" data-i18n="incorrect_answers">Incorrect</div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-number formatted-number" id="final-score">80%</div>
                        <div class="stat-label" data-i18n="your_score">Score</div>
                    </div>
                </div>

                <div class="encouragement" id="encouragement-message">
                    You're doing amazing! Keep practicing to improve even more!
                </div>

                <div class="results-actions">
                    <button id="try-again-btn" class="btn btn--primary btn--lg" data-i18n="try_again">Try Again</button>
                    <button id="different-exercise-btn" class="btn btn--secondary btn--lg" data-i18n="different_exercise">Try Different Exercise</button>
                    <button id="back-dashboard-btn" class="btn btn--outline btn--lg" data-i18n="back_to_dashboard">Back to Dashboard</button>
                </div>
            </div>
        </div>

        <!-- Progress Screen -->
        <div id="progress" class="screen">
            <div class="container">
                <div class="progress-header">
                    <button id="back-from-progress" class="btn btn--secondary btn--sm" data-i18n="back">← Back</button>
                    <h2 data-i18n="your_progress">Your Progress</h2>
                </div>

                <div class="progress-overview">
                    <div class="progress-card">
                        <h3 data-i18n="overall_stats">Overall Statistics</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-value" id="total-exercises">0</span>
                                <span class="stat-name" data-i18n="total_exercises">Total Exercises</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="total-correct">0</span>
                                <span class="stat-name" data-i18n="total_correct">Total Correct</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="best-streak">0</span>
                                <span class="stat-name" data-i18n="best_streak">Best Streak</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="days-practiced">0</span>
                                <span class="stat-name" data-i18n="days_practiced">Days Practiced</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="exercise-breakdown">
                    <h3 data-i18n="exercise_breakdown">Exercise Type Breakdown</h3>
                    <div class="breakdown-grid">
                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="exercise-symbol mult">×</span>
                                <span data-i18n="multiplication">Multiplication</span>
                            </div>
                            <div class="breakdown-stats">
                                <span id="mult-accuracy">0%</span> <span data-i18n="accuracy">accuracy</span>
                                <span id="mult-total">0</span> <span data-i18n="completed">completed</span>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="exercise-symbol sub">−</span>
                                <span data-i18n="subtraction">Subtraction</span>
                            </div>
                            <div class="breakdown-stats">
                                <span id="sub-accuracy">0%</span> <span data-i18n="accuracy">accuracy</span>
                                <span id="sub-total">0</span> <span data-i18n="completed">completed</span>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="exercise-symbol div">÷</span>
                                <span data-i18n="division">Division</span>
                            </div>
                            <div class="breakdown-stats">
                                <span id="div-accuracy">0%</span> <span data-i18n="accuracy">accuracy</span>
                                <span id="div-total">0</span> <span data-i18n="completed">completed</span>
                            </div>
                        </div>
                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="exercise-symbol add">+</span>
                                <span data-i18n="addition">Addition</span>
                            </div>
                            <div class="breakdown-stats">
                                <span id="add-accuracy">0%</span> <span data-i18n="accuracy">accuracy</span>
                                <span id="add-total">0</span> <span data-i18n="completed">completed</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    
    <style>
    /* Additional styles for data persistence features */
    .loading-indicator {
        text-align: center;
        padding: 20px;
        background: var(--color-bg-1);
        border-radius: var(--radius-lg);
        margin: 20px 0;
    }
    
    .loading-spinner {
        width: 30px;
        height: 30px;
        border: 3px solid var(--color-bg-2);
        border-top: 3px solid var(--color-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 16px;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .data-status-info {
        background: var(--color-bg-3);
        border: 2px solid var(--color-success);
        border-radius: var(--radius-lg);
        padding: 16px;
        margin: 20px 0;
        text-align: center;
    }
    
    .status-message {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-weight: var(--font-weight-medium);
        color: var(--color-success);
    }
    
    .status-icon {
        font-size: 1.2em;
    }
    
    .data-persistence-info {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        background: var(--color-bg-1);
        border-radius: var(--radius-base);
        padding: 16px;
        margin-top: 24px;
        border-left: 4px solid var(--color-primary);
    }
    
    .info-icon {
        font-size: 1.5em;
        flex-shrink: 0;
    }
    
    .info-text {
        flex: 1;
    }
    
    .info-title {
        font-weight: var(--font-weight-bold);
        color: var(--color-primary);
        margin-bottom: 4px;
        font-size: var(--font-size-base);
    }
    
    .info-desc {
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
        line-height: 1.4;
    }
    
    .no-users-message {
        animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    /* RTL support for new elements */
    [dir="rtl"] .data-persistence-info {
        border-left: none;
        border-right: 4px solid var(--color-primary);
    }
    
    [dir="rtl"] .status-message {
        flex-direction: row-reverse;
    }
    </style>
</body>
</html>